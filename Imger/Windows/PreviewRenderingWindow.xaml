<Window
    x:Class="Imger.Forms.PreviewRenderingWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:Imger.Forms"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="Imger - Preview rendering"
    Width="1000"
    Height="700"
    SnapsToDevicePixels="True"
    UseLayoutRounding="True"
    mc:Ignorable="d">
    <Grid Background="#222">
        <!--  外层 Border 便于接收鼠标事件与限定显示区域  -->
        <Border
            x:Name="Host"
            Background="#111"
            ClipToBounds="True">
            <!--  容器：使用 MatrixTransform 统一处理缩放与平移  -->
            <Grid>
                <Image
                    x:Name="Img"
                    CacheMode="{x:Null}"
                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                    RenderOptions.EdgeMode="Unspecified"
                    Stretch="None">
                    <Image.LayoutTransform>
                        <!--  不用 LayoutTransform，避免布局反复计算；这里占位但保持为空  -->
                        <TransformGroup />
                    </Image.LayoutTransform>
                    <Image.RenderTransform>
                        <MatrixTransform x:Name="ViewTransform" />
                    </Image.RenderTransform>
                </Image>
            </Grid>
        </Border>
        <!--  右下角小提示  -->
        <Border
            Margin="10"
            Padding="8"
            HorizontalAlignment="Right"
            VerticalAlignment="Bottom"
            Background="#66000000"
            CornerRadius="6">
            <TextBlock
                FontSize="12"
                Foreground="White"
                Text="Roller: Zoom ·Drag with left button: Pan ·Double-click right button: Reset" />
        </Border>
    </Grid>
</Window>
